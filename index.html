<!DOCTYPE html>
<html lang="zh-CN">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Mermaid Editor — Mermaid 图表转图片工具</title>
  <meta name="description" content="在线 Mermaid 代码转图片工具，支持流程图、时序图、甘特图等，实时预览并一键导出 SVG/PNG。Online Mermaid diagram to image converter with live preview and SVG/PNG export.">
  <meta name="keywords" content="mermaid, mermaid转图片, mermaid to image, 流程图转图片, diagram to image, flowchart export, SVG export, PNG export, mermaid editor">
  <meta name="author" content="Mermaid Editor">
  <meta name="robots" content="index, follow">
  <link rel="canonical" href="https://ericcao.github.io/mermaid-pic/">

  <!-- Open Graph -->
  <meta property="og:type" content="website">
  <meta property="og:title" content="Mermaid Editor — Mermaid 图表转图片工具">
  <meta property="og:description" content="在线 Mermaid 代码转图片工具，实时预览，一键导出 SVG/PNG。Online Mermaid diagram to image converter.">
  <meta property="og:url" content="https://ericcao.github.io/mermaid-pic/">

  <!-- Favicon: Mermaid-style graph icon -->
  <link rel="icon" type="image/svg+xml" href="data:image/svg+xml,<svg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 32 32'><rect width='32' height='32' rx='6' fill='%23333'/><circle cx='16' cy='7' r='3' fill='%2300b4d8'/><circle cx='7' cy='25' r='3' fill='%2300b4d8'/><circle cx='25' cy='25' r='3' fill='%2300b4d8'/><line x1='16' y1='10' x2='7' y2='22' stroke='%2300b4d8' stroke-width='2'/><line x1='16' y1='10' x2='25' y2='22' stroke='%2300b4d8' stroke-width='2'/></svg>">

  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Outfit:wght@400;500;600;700&family=JetBrains+Mono:wght@400;500&family=LXGW+WenKai+TC&display=swap">
  <style>
    @font-face {
      font-family: 'Virgil';
      src: url('https://cdn.jsdelivr.net/gh/excalidraw/virgil/Virgil.woff2') format('woff2');
      font-display: swap;
    }
  </style>
  <link rel="stylesheet" href="style.css">
  <script type="importmap">
  {
    "imports": {
      "codemirror": "https://esm.sh/codemirror@6.0.1/es2022/codemirror.mjs",
      "@codemirror/state": "https://esm.sh/@codemirror/state@6",
      "@codemirror/view": "https://esm.sh/@codemirror/view@6",
      "@codemirror/language": "https://esm.sh/@codemirror/language@6",
      "@codemirror/autocomplete": "https://esm.sh/@codemirror/autocomplete@6",
      "@codemirror/commands": "https://esm.sh/@codemirror/commands@6",
      "@codemirror/lint": "https://esm.sh/@codemirror/lint@6",
      "@codemirror/search": "https://esm.sh/@codemirror/search@6",
      "@codemirror/theme-one-dark": "https://esm.sh/@codemirror/theme-one-dark@6",
      "@lezer/common": "https://esm.sh/@lezer/common@1",
      "@lezer/highlight": "https://esm.sh/@lezer/highlight@1",
      "@lezer/lr": "https://esm.sh/@lezer/lr@1",
      "codemirror-lang-mermaid": "https://esm.sh/codemirror-lang-mermaid@0.5.0"
    }
  }
  </script>
</head>
<body>
  <header class="toolbar">
    <h1 class="toolbar__title">
      <svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="12" cy="5" r="3"/><circle cx="5" cy="19" r="3"/><circle cx="19" cy="19" r="3"/><line x1="12" y1="8" x2="5" y2="16"/><line x1="12" y1="8" x2="19" y2="16"/></svg>
      Mermaid Editor
    </h1>
    <div class="toolbar__controls">
      <!-- Left group: style controls -->
      <div class="toolbar__group">
        <!-- Hand-drawn toggle -->
        <button id="hand-drawn-btn" class="btn-icon btn-hand-drawn active" title="手绘风格 (Hand-drawn style)" aria-pressed="true">
          <svg width="15" height="15" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M3 17c3-3 6-5 9-5s6 2 9 5"/><path d="M3 7c3 3 6 5 9 5s6-2 9-5"/></svg>
          手绘
        </button>
      </div>

      <!-- hidden select kept for JS compatibility -->
      <select id="theme-select" style="display:none">
        <option value="default">Default</option>
        <option value="dark">Dark</option>
        <option value="forest">Forest</option>
        <option value="neutral">Neutral</option>
        <option value="base">Base</option>
      </select>

      <div class="toolbar__sep"></div>

      <!-- Center group: share + export actions -->
      <div class="toolbar__group toolbar__group--actions">
        <!-- Share split button -->
        <div class="export-dropdown" id="share-dropdown">
          <button class="btn-export-main btn-share-main" id="btn-share" title="复制分享链接">
            <svg width="13" height="13" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71"/><path d="M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71"/></svg>
            分享
          </button>
          <button class="btn-export-arrow btn-share-arrow" id="share-dropdown-toggle" title="更多分享选项">
            <svg width="10" height="10" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2.5"><polyline points="6 9 12 15 18 9"/></svg>
          </button>
          <div class="export-dropdown__menu" id="share-dropdown-menu">
            <button id="btn-embed-code">
              <svg width="13" height="13" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><polyline points="16 18 22 12 16 6"/><polyline points="8 6 2 12 8 18"/></svg>
              嵌入代码
            </button>
            <button id="btn-copy-ai-prompt">
              <svg width="13" height="13" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M12 2a2 2 0 0 1 2 2v1h3a1 1 0 0 1 1 1v14a1 1 0 0 1-1 1H5a1 1 0 0 1-1-1V6a1 1 0 0 1 1-1h3V4a2 2 0 0 1 2-2z"/><path d="M9 12h6M9 16h4"/></svg>
              AI 提示词
            </button>
          </div>
        </div>

        <!-- Export dropdown -->
        <div class="export-dropdown" id="export-dropdown">
          <button class="btn-export-main" id="btn-download-png" title="下载 PNG (Ctrl+Shift+S)">
            <svg width="13" height="13" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4"/><polyline points="7 10 12 15 17 10"/><line x1="12" y1="15" x2="12" y2="3"/></svg>
            下载
          </button>
          <button class="btn-export-arrow" id="export-dropdown-toggle" title="更多导出选项">
            <svg width="10" height="10" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2.5"><polyline points="6 9 12 15 18 9"/></svg>
          </button>
          <div class="export-dropdown__menu" id="export-dropdown-menu">
            <button id="btn-download-svg" title="下载 SVG (Ctrl+S)">
              <svg width="13" height="13" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4"/><polyline points="7 10 12 15 17 10"/><line x1="12" y1="15" x2="12" y2="3"/></svg>
              下载 SVG
            </button>
            <button id="btn-copy-png" title="复制 PNG (Ctrl+Shift+P)">
              <svg width="13" height="13" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><rect x="9" y="9" width="13" height="13" rx="2"/><path d="M5 15H4a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h9a2 2 0 0 1 2 2v1"/></svg>
              复制 PNG
            </button>
            <div class="export-dropdown__sep"></div>
            <div class="export-dropdown__bg">
              <span class="export-dropdown__bg-label">导出背景</span>
              <select id="export-bg-select">
                <option value="white">白色</option>
                <option value="transparent">透明</option>
                <option value="black">黑色</option>
                <option value="custom">自定义</option>
              </select>
              <input type="color" id="export-bg-custom" value="#ffffff" style="display:none;width:28px;height:24px;padding:1px 2px;border-radius:4px;cursor:pointer;">
            </div>
          </div>
        </div>
      </div>

      <div class="toolbar__sep"></div>

      <!-- Right group: utility buttons -->
      <div class="toolbar__group">
        <!-- GitHub -->
        <a href="https://github.com/caoergou/mermaid-pic" target="_blank" rel="noopener" class="btn-icon toolbar-link" title="GitHub 项目">
          <svg width="15" height="15" viewBox="0 0 24 24" fill="currentColor"><path d="M12 2C6.477 2 2 6.484 2 12.017c0 4.425 2.865 8.18 6.839 9.504.5.092.682-.217.682-.483 0-.237-.008-.868-.013-1.703-2.782.605-3.369-1.343-3.369-1.343-.454-1.158-1.11-1.466-1.11-1.466-.908-.62.069-.608.069-.608 1.003.07 1.531 1.032 1.531 1.032.892 1.53 2.341 1.088 2.91.832.092-.647.35-1.088.636-1.338-2.22-.253-4.555-1.113-4.555-4.951 0-1.093.39-1.988 1.029-2.688-.103-.253-.446-1.272.098-2.65 0 0 .84-.27 2.75 1.026A9.564 9.564 0 0 1 12 6.844a9.59 9.59 0 0 1 2.504.337c1.909-1.296 2.747-1.027 2.747-1.027.546 1.379.202 2.398.1 2.651.64.7 1.028 1.595 1.028 2.688 0 3.848-2.339 4.695-4.566 4.943.359.309.678.92.678 1.855 0 1.338-.012 2.419-.012 2.747 0 .268.18.58.688.482A10.02 10.02 0 0 0 22 12.017C22 6.484 17.522 2 12 2z"/></svg>
        </a>

        <!-- Help -->
        <button id="btn-help" class="btn-icon" title="示例与快捷键">
          <svg width="15" height="15" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><circle cx="12" cy="12" r="10"/><path d="M9.09 9a3 3 0 0 1 5.83 1c0 2-3 3-3 3"/><line x1="12" y1="17" x2="12.01" y2="17"/></svg>
        </button>

        <!-- Dark mode toggle -->
        <button id="ui-theme-toggle" class="btn-icon btn-theme-toggle" title="切换深色/浅色模式" aria-pressed="false">
          <svg id="icon-sun" width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><circle cx="12" cy="12" r="5"/><line x1="12" y1="1" x2="12" y2="3"/><line x1="12" y1="21" x2="12" y2="23"/><line x1="4.22" y1="4.22" x2="5.64" y2="5.64"/><line x1="18.36" y1="18.36" x2="19.78" y2="19.78"/><line x1="1" y1="12" x2="3" y2="12"/><line x1="21" y1="12" x2="23" y2="12"/><line x1="4.22" y1="19.78" x2="5.64" y2="18.36"/><line x1="18.36" y1="5.64" x2="19.78" y2="4.22"/></svg>
          <svg id="icon-moon" width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" style="display:none"><path d="M21 12.79A9 9 0 1 1 11.21 3 7 7 0 0 0 21 12.79z"/></svg>
          <span id="theme-toggle-label">浅色</span>
        </button>

        <!-- Mobile overflow menu button (hidden on desktop) -->
        <button id="btn-mobile-more" class="btn-icon toolbar__mobile-more" title="更多选项" style="display:none">
          <svg width="15" height="15" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><circle cx="12" cy="5" r="1" fill="currentColor"/><circle cx="12" cy="12" r="1" fill="currentColor"/><circle cx="12" cy="19" r="1" fill="currentColor"/></svg>
        </button>
      </div>
    </div>
  </header>

  <main class="editor-layout">
    <!-- Mobile tab bar -->
    <div class="mobile-tabs" id="mobile-tabs">
      <button class="mobile-tab active" id="tab-editor" data-i18n="editor">编辑器</button>
      <button class="mobile-tab" id="tab-preview" data-i18n="preview">预览</button>
    </div>
    <div class="panel panel--editor">
      <div class="panel__header">
        <span>编辑器</span>
        <span id="editor-status" class="panel__status"></span>
      </div>
      <div class="examples-strip" id="examples-strip"></div>
      <div id="editor-container"></div>
      <div class="history-bar" id="history-bar">
        <span class="history-bar__label">历史</span>
        <div class="history-list" id="history-list"></div>
      </div>
    </div>
    <div id="divider" title="拖拽调整面板大小 · Drag to resize"></div>
    <div class="panel panel--preview">
      <div class="panel__header">
        <span>预览</span>
        <div class="theme-pills-wrap">
          <div class="theme-pills" id="theme-pills" role="radiogroup" aria-label="Mermaid 主题">
            <button class="theme-pill active" data-theme="default" role="radio" aria-checked="true">Default</button>
            <button class="theme-pill" data-theme="dark" role="radio" aria-checked="false">Dark</button>
            <button class="theme-pill" data-theme="forest" role="radio" aria-checked="false">Forest</button>
            <button class="theme-pill" data-theme="neutral" role="radio" aria-checked="false">Neutral</button>
            <button class="theme-pill" data-theme="base" role="radio" aria-checked="false">Base</button>
          </div>
        </div>
        <div class="panel__actions">
          <div class="zoom-controls">
            <button id="btn-zoom-out" class="btn-tiny" title="缩小">
              <svg width="11" height="11" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2.5"><line x1="5" y1="12" x2="19" y2="12"/></svg>
            </button>
            <span id="zoom-label" class="zoom-label">100%</span>
            <button id="btn-zoom-in" class="btn-tiny" title="放大">
              <svg width="11" height="11" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2.5"><line x1="12" y1="5" x2="12" y2="19"/><line x1="5" y1="12" x2="19" y2="12"/></svg>
            </button>
            <button id="btn-zoom-reset" class="btn-tiny" title="重置视图">
              <svg width="11" height="11" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M3 12a9 9 0 1 0 9-9 9.75 9.75 0 0 0-6.74 2.74L3 8"/><path d="M3 3v5h5"/></svg>
            </button>
          </div>
          <div class="panel__sep-v"></div>
          <button id="btn-bg-toggle" class="btn-tiny" title="切换棋盘格背景">
            <svg width="11" height="11" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><rect x="3" y="3" width="18" height="18" rx="2"/><path d="M3 9h18M9 21V9"/></svg>
          </button>
          <span id="render-status" class="render-status"></span>
        </div>
      </div>
      <div id="preview-viewport" class="preview-viewport">
        <div id="mermaid-preview" class="preview-container"></div>
      </div>
    </div>
  </main>

  <div id="toast" class="toast"></div>

  <!-- Mobile overflow menu -->
  <div id="mobile-overflow-menu" class="mobile-overflow-menu">
    <div class="mobile-overflow-menu__backdrop" id="mobile-overflow-backdrop"></div>
    <div class="mobile-overflow-menu__panel">
      <button class="mobile-overflow-menu__item" id="mob-btn-share">
        <svg width="15" height="15" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71"/><path d="M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71"/></svg>
        分享链接
      </button>
      <div class="mobile-overflow-menu__sep"></div>
      <button class="mobile-overflow-menu__item" id="mob-btn-download-png">
        <svg width="15" height="15" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4"/><polyline points="7 10 12 15 17 10"/><line x1="12" y1="15" x2="12" y2="3"/></svg>
        下载 PNG
      </button>
      <button class="mobile-overflow-menu__item" id="mob-btn-download-svg">
        <svg width="15" height="15" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4"/><polyline points="7 10 12 15 17 10"/><line x1="12" y1="15" x2="12" y2="3"/></svg>
        下载 SVG
      </button>
      <div class="mobile-overflow-menu__sep"></div>
      <button class="mobile-overflow-menu__item" id="mob-btn-help">
        <svg width="15" height="15" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><circle cx="12" cy="12" r="10"/><path d="M9.09 9a3 3 0 0 1 5.83 1c0 2-3 3-3 3"/><line x1="12" y1="17" x2="12.01" y2="17"/></svg>
        示例与快捷键
      </button>
    </div>
  </div>

  <!-- Interactive Tour -->
  <div id="tour-overlay" class="tour-overlay" style="display:none">
    <div id="tour-curtain-top"    class="tour-curtain"></div>
    <div id="tour-curtain-bottom" class="tour-curtain"></div>
    <div id="tour-curtain-left"   class="tour-curtain"></div>
    <div id="tour-curtain-right"  class="tour-curtain"></div>
    <div id="tour-highlight" class="tour-highlight"></div>
    <div id="tour-tooltip" class="tour-tooltip">
      <div id="tour-step" class="tour-tooltip__step"></div>
      <div id="tour-title" class="tour-tooltip__title"></div>
      <div id="tour-body" class="tour-tooltip__body"></div>
      <div class="tour-tooltip__footer">
        <div id="tour-dots" class="tour-dots"></div>
        <div style="display:flex;gap:6px">
          <button id="tour-skip" class="tour-btn">跳过 Skip</button>
          <button id="tour-next" class="tour-btn primary">下一步 Next →</button>
        </div>
      </div>
    </div>
  </div>

  <!-- Example picker modal (triggered from help button) -->
  <div id="help-modal" class="modal-overlay" role="dialog" aria-modal="true" aria-labelledby="modal-title">
    <div class="modal">
      <div class="modal__header">
        <h2 id="modal-title">示例模板 · Examples</h2>
        <button id="modal-close" class="btn-icon" title="关闭 Close">
          <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><line x1="18" y1="6" x2="6" y2="18"/><line x1="6" y1="6" x2="18" y2="18"/></svg>
        </button>
      </div>
      <div class="modal__body">
        <div class="help-section">
          <h3>选择一个示例开始 · Pick an example to start</h3>
          <div class="example-grid" id="modal-example-grid"></div>
        </div>
        <div class="help-section">
          <h3>快捷键 · Shortcuts</h3>
          <table class="help-table">
            <tr><td>立即渲染 · Force render</td><td><kbd>Ctrl</kbd>+<kbd>Enter</kbd></td></tr>
            <tr><td>复制 PNG · Copy PNG</td><td><kbd>Ctrl</kbd>+<kbd>Shift</kbd>+<kbd>P</kbd></td></tr>
            <tr><td>下载 SVG · Download SVG</td><td><kbd>Ctrl</kbd>+<kbd>S</kbd></td></tr>
            <tr><td>下载 PNG · Download PNG</td><td><kbd>Ctrl</kbd>+<kbd>Shift</kbd>+<kbd>S</kbd></td></tr>
          </table>
        </div>
      </div>
      <div class="modal__footer">
        <button id="btn-restart-tour" class="tour-btn" style="background:var(--btn-bg);color:var(--btn-text);border-color:var(--border-color)">
          重新引导 · Restart Tour
        </button>
        <button id="modal-ok" class="btn-primary">关闭 Close</button>
      </div>
    </div>
  </div>

  <script src="https://cdn.jsdelivr.net/npm/mermaid@11/dist/mermaid.min.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/pako@2.1.0/dist/pako.min.js"></script>
  <script type="module" src="app.js"></script>
</body>
</html>
